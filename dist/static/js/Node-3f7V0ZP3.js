import{h as k}from"./moment-DFa0WlA5.js";import{b as v,c as N}from"./workflow-B85YQqXY.js";import{_ as D,m as s,E as P,c as B,e as _,b as e,h as a,w as x,g as E,r as d,j as K,o as b,f as m,t as y}from"./index-DfmCOzbx.js";const M="TEST_CALLER",S={setup(){const n=s([]),l=s(1),c=s(10),o=s(""),g=s(0),i=s(!1),u=s(!1),f=s({blur:"",operator:"",tenant:"",flowKey:""}),r={0:"默认",1:"草稿",2:"编辑中",3:"已下线",4:"已发布"};return{tableData:n,currentPage:l,pageSize:c,blur:o,moment:k,loading:i,getStatus:p=>r[p],dialogVisible:u,total:g,formInfo:f}},mounted(){this.findByPage()},methods:{findByPage(){this.loading=!0,v({current:this.currentPage,size:this.pageSize,blur:this.blur}).then(({data:n})=>{const{records:l,total:c}=n;this.tableData=l,this.loading=!1,this.total=c}).catch(n=>{this.loading=!1})},$_goDetail(n){this.$router.push({path:`/flow/${n}`})},showCreateFlow(){this.dialogVisible=!0},createFlowClick(){N({caller:M,flowName:this.formInfo.flowName,flowKey:this.formInfo.flowKey,operator:this.formInfo.operator,tenant:"TEST_TENANT"}).then(({data:n,errCode:l})=>{if(l===1e3){const{flowModuleId:c}=n;this.$_goDetail(c)}else throw new Error(n)}).catch(n=>{P({showClose:!0,message:"新建流程失败",type:"error"})})}}},T={class:"flow-container"},U={class:"flow-buttons"},F={class:"flow-list"},z={class:"dialog-footer"};function L(n,l,c,o,g,i){const u=d("el-input"),f=d("el-button"),r=d("el-table-column"),h=d("el-table"),p=d("el-pagination"),w=d("el-form-item"),C=d("el-form"),V=d("el-dialog"),I=K("loading");return b(),B("div",T,[_("div",U,[e(u,{modelValue:o.blur,"onUpdate:modelValue":l[0]||(l[0]=t=>o.blur=t),class:"flow-search",placeholder:"模糊搜索",onChange:i.findByPage},null,8,["modelValue","onChange"]),e(f,{type:"primary",class:"search-flow",onClick:i.findByPage},{default:a(()=>[m("查询")]),_:1},8,["onClick"]),e(f,{type:"primary",class:"create-flow",onClick:i.showCreateFlow},{default:a(()=>[m("新建流程")]),_:1},8,["onClick"])]),_("div",F,[x((b(),E(h,{data:o.tableData,style:{width:"100%"}},{default:a(()=>[e(r,{type:"index",width:"50"}),e(r,{prop:"flowModuleId",label:"flowModuleId","show-overflow-tooltip":""}),e(r,{prop:"flowName",label:"流程名称"}),e(r,{prop:"flowKey",label:"flowKey"}),e(r,{label:"流程状态"},{default:a(t=>[m(y(o.getStatus(t.row.status)),1)]),_:1}),e(r,{label:"修改时间","min-width":"150"},{default:a(t=>[m(y(o.moment(t.row.modifyTime).format("YYYY/MM/DD HH:mm:ss")),1)]),_:1}),e(r,{prop:"operator",label:"修改人",width:"120"}),e(r,{label:"操作",width:"200"},{default:a(t=>[e(f,{type:"primary",size:"small",onClick:Y=>i.$_goDetail(t.row.flowModuleId)},{default:a(()=>[m("查看流程")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[I,o.loading]]),e(p,{layout:"prev, pager, next",total:o.total,"current-page":o.currentPage,"onUpdate:currentPage":l[1]||(l[1]=t=>o.currentPage=t),onCurrentChange:i.findByPage},null,8,["total","current-page","onCurrentChange"])]),e(V,{modelValue:o.dialogVisible,"onUpdate:modelValue":l[6]||(l[6]=t=>o.dialogVisible=t),title:"新建流程",width:"30%"},{footer:a(()=>[_("span",z,[e(f,{onClick:l[5]||(l[5]=t=>o.dialogVisible=!1)},{default:a(()=>[m("取消")]),_:1}),e(f,{type:"primary",onClick:i.createFlowClick},{default:a(()=>[m("新建")]),_:1},8,["onClick"])])]),default:a(()=>[e(C,{"label-position":n.right,"label-width":"100px",model:o.formInfo,style:{"max-width":"460px"}},{default:a(()=>[e(w,{label:"流程名称",prop:"flowName"},{default:a(()=>[e(u,{modelValue:o.formInfo.flowName,"onUpdate:modelValue":l[2]||(l[2]=t=>o.formInfo.flowName=t)},null,8,["modelValue"])]),_:1}),e(w,{label:"flowKey",prop:"flowKey"},{default:a(()=>[e(u,{modelValue:o.formInfo.flowKey,"onUpdate:modelValue":l[3]||(l[3]=t=>o.formInfo.flowKey=t)},null,8,["modelValue"])]),_:1}),e(w,{label:"创建人",prop:"operator"},{default:a(()=>[e(u,{modelValue:o.formInfo.operator,"onUpdate:modelValue":l[4]||(l[4]=t=>o.formInfo.operator=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["label-position","model"])]),_:1},8,["modelValue"])])}const j=D(S,[["render",L],["__scopeId","data-v-bab4197c"]]);export{j as default};
